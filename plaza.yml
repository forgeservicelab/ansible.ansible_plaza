---
- hosts: nfs
  sudo: True
  roles:
    - nfs
  tags:
    - nfs

- hosts: mysql
  sudo: True
  roles:
    - mysql
  tags:
    - mysql

- hosts: drupal
  sudo: True
  pre_tasks:
    - apt:
        name: "{{ item }}"
        state: latest
        update_cache: yes
      with_items:
        - php-pear
  roles:
    - role: drush
      drush_install_mode: pear
      drushrc:
        root: /var/www
    - role: memcached
      memcached_cache_size: 512
    - role: memcached
      memcached_instance_name: session
      memcached_cache_size: 256
      memcached_port: 11221
    - role: memcached
      memcached_instance_name: users
      memcached_cache_size: 256
      memcached_port: 11222
    - drupal
  tags:
    - drupal

- hosts: loadbalancer
  sudo: True
  roles:
    - ha-loadbalancer
  tags:
    - loadbalancer
